# CSS Architecture & Inheritance Guide

## Overview

AKSEP-NEU follows a **hierarchical CSS inheritance pattern** that ensures:
- Clear separation of concerns (variables â†’ themes â†’ patterns â†’ components â†’ content pages)
- Scalability for nested component structures
- Single source of truth for design tokens
- Minimal CSS bundle size through efficient cascading

Every CSS file knows exactly what it inherits from and what it provides to its children.

---

## File Hierarchy & Inheritance Chain

```txt
src/styles/
â”œâ”€â”€ globals.css
â”‚   â””â”€â”€ Defines: CSS custom properties (--spacing, --radius, --text-*, raw color values)
â”‚       Imports: None
â”‚
â”œâ”€â”€ themes.css
â”‚   â””â”€â”€ Defines: Semantic CSS variables (--foreground, --background, --primary, etc.)
â”‚       Imports: ./globals.css
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ .shared.css â­ (Hierarchy Level 1)
â”‚   â”‚   â””â”€â”€ Defines: App shell, card patterns, dropdown, separator (reusable component patterns)
â”‚   â”‚       Imports: ../themes.css
â”‚   â”‚
â”‚   â”œâ”€â”€ content-sections.css â”€â”
â”‚   â”œâ”€â”€ footer.css            â”‚
â”‚   â”œâ”€â”€ navigation.css        â”‚ Legacy entry point (stub)
â”‚   â”œâ”€â”€ page-shell.css        â”‚ All import: ./.shared.css
â”‚   â””â”€â”€ shared.css âš ï¸         â”‚ (Utility components for Bullet/Caption/Heading)
â”‚       â””â”€â”€ Imports: ./.shared.css
â”‚
â”‚   â”œâ”€â”€ content-sections/
â”‚   â”‚   â”œâ”€â”€ .shared.css â­ (Hierarchy Level 2)
â”‚   â”‚   â”‚   â””â”€â”€ Imports: ../.shared.css
â”‚   â”‚   â”œâ”€â”€ start.css
â”‚   â”‚   â”‚   â””â”€â”€ Imports: ./.shared.css
â”‚   â”‚   â””â”€â”€ start/
â”‚   â”‚       â”œâ”€â”€ .shared.css â­ (Hierarchy Level 3)
â”‚   â”‚       â”‚   â””â”€â”€ Imports: ../.shared.css
â”‚   â”‚       â”œâ”€â”€ akronym.css
â”‚   â”‚       â”œâ”€â”€ aktuell.css
â”‚   â”‚       â”œâ”€â”€ hero.css
â”‚   â”‚       â””â”€â”€ mitmachen.css
â”‚   â”‚           â””â”€â”€ Each imports: ./.shared.css
â”‚   â”‚
â”‚   â”œâ”€â”€ navigation/
â”‚   â”‚   â”œâ”€â”€ .shared.css â­ (Hierarchy Level 2)
â”‚   â”‚   â”‚   â””â”€â”€ Imports: ../.shared.css
â”‚   â”‚   â”œâ”€â”€ nav-shell.css        â”€ Main layout + branding shell
â”‚   â”‚   â”œâ”€â”€ nav-item.css         â”€ Primary navigation items + dropdowns
â”‚   â”‚   â”œâ”€â”€ nav-overflow.css     â”€ Overflow menu logic
â”‚   â”‚   â”œâ”€â”€ nav-button.css       â”
â”‚   â”‚   â”œâ”€â”€ nav-dropdown.css     â”‚
â”‚   â”‚   â”œâ”€â”€ nav-group.css        â”‚ Prepared placeholders (future variants)
â”‚   â”‚   â”œâ”€â”€ nav-logo.css         â”‚
â”‚   â”‚   â”œâ”€â”€ nav-overflow-collector.css â”‚
â”‚   â”‚   â””â”€â”€ sidebar.css          â”˜
â”‚   â”‚       â””â”€â”€ All import: ./.shared.css
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ .shared.css â­ (Hierarchy Level 2)
â”‚   â”‚   â”‚   â””â”€â”€ Imports: ../.shared.css
â”‚   â”‚   â”œâ”€â”€ bullet.css
â”‚   â”‚   â”œâ”€â”€ caption.css
â”‚   â”‚   â””â”€â”€ heading.css
â”‚   â”‚       â””â”€â”€ Each imports: ./.shared.css
â”‚   â”‚
â”‚   â””â”€â”€ ui/
â”‚       â””â”€â”€ .figma-ui-components.css ğŸ¨
â”‚           â””â”€â”€ [SPECIAL: generated, exempt from hierarchy rule]
â”‚
â””â”€â”€ content/
   â”œâ”€â”€ .shared.css â­ (Hierarchy Level 1 for pages)
   â”‚   â””â”€â”€ Imports: ../themes.css
   â”œâ”€â”€ not-found.css
   â”œâ”€â”€ standard.css
   â””â”€â”€ start.css
      â””â”€â”€ Each imports: ./.shared.css
```

---

## Understanding the Inheritance Pattern

### The 5-Level Pyramid

```txt
Level 0: globals.css (CSS variables only)
    â†“
Level 1: themes.css (semantic variables)
    â†“
Level 2: components/.shared.css (app-level patterns)
    â”œâ†’ Level 3: components/<group>/.shared.css (group-level patterns)
    â”‚   â””â†’ Level 4: components/<group>/<component>.css (specific component)
    â”‚
    â””â†’ Level 4: components/<component>.css (flat component)
    
content/ (NO imports, content-only assembly layer)
```

### Key Rules

1. **Each file imports exactly ONE parent** (no skipping levels):
   - âŒ `component.css` should NOT import `../themes.css`
   - âœ… `component.css` should import `./.shared.css` (which imports themes)

2. **`.shared.css` is a hierarchy marker** (prefix with dot):
   - `.shared.css` = Inheritance point for a group/level
   - `shared.css` (no dot) = Normal component CSS file
   - These are DIFFERENT files in DIFFERENT contexts

3. **Content layer is read-only**:
   - `content/*.css` only imports component CSS files
   - NEVER imports `themes.css` or any `.shared.css`
   - Acts as a "content assembly layer" only

4. **No circular imports**:
   - Parent â†’ Child always one direction
   - No file imports from a deeper level back upward

---

## File Roles & Responsibilities

| File | Role | Defines | Imports | Used By |
|------|------|---------|---------|---------|
| `globals.css` | Base variables | CSS custom properties, raw colors, spacing, typography scale | None | `themes.css` |
| `themes.css` | Semantic tokens | Color roles (primary, secondary, accent), component tokens | `globals.css` | `.shared.css` files |
| `.shared.css` (Level N) | Hierarchy root | Patterns for this level's scope | `themes.css` or parent `.shared.css` | Child components |
| `<component>.css` | Component styles | Component-specific rules | `./.shared.css` | TypeScript component |
| `content/*.css` | Content assembly | Page-specific layout/spacing | Component CSS files | Page entrypoints |

---

## Special Cases

### Figma UI Components (`.figma-ui-components.css`)

**Location:** `src/styles/components/ui/.figma-ui-components.css`

**Special Status:**
- Generated by Figma Make (not hand-written)
- Contains: Pre-styled UI components from Figma design system
- **Imports:** âŒ None (standalone, self-contained)
- **Usage:** Optional; can be used as-is or overridden by project styles

**Best Practice:**
- Leave this file untouched unless updating from Figma
- Project-specific component overrides go in separate `.css` files
- Do not modify or reorganize this file manually

### Navigation Module (`nav-*` pattern)

**Location:** `src/styles/components/navigation/`

**Structure Highlights:**
- `.shared.css` imports the parent `../.shared.css` and provides tokens shared across every navigation sub-component.
- `nav-shell.css`, `nav-item.css`, and `nav-overflow.css` hold the real layout, dropdown, and overflow styles that back the TypeScript counterparts (`Navigation.tsx`, `NavItem.tsx`, `NavOverflow.tsx`).
- Remaining files (`nav-button.css`, `nav-dropdown.css`, `nav-group.css`, `nav-logo.css`, `nav-overflow-collector.css`, `sidebar.css`) are intentionally lightweight placeholders that already import `./.shared.css`; populate them when the corresponding components materialise.
- The legacy `src/styles/components/navigation.css` stays in place as a stub importing `./.shared.css`, keeping historical import paths alive while delegating actual rules to the new `nav-*` files.

---

## Rules for New Components

### Checklist for Adding a New Component

When creating a new component at `src/components/path/ComponentName.tsx`:

1. **Determine your level**

   Flat component (e.g., `Button.tsx`)? â†’ Create `src/styles/components/button.css`
   Nested component (e.g., `groups/Item.tsx`)? â†’ Create `src/styles/components/groups/.shared.css` + `src/styles/components/groups/item.css`

2. **Create the CSS file**

   ```css
   /**
    * ComponentName Styles
    * Brief description of what this component does
    */
   @import '<path-to-parent-.shared.css>';

   /* Your component styles here */
   ```

3. **Import in your TypeScript**

   ```tsx
   import '@/styles/components/component-name.css';
   
   export function ComponentName() {
     return <div className="component-name-root">...</div>;
   }
   ```

4. **Verify**

   - âœ… No circular imports
   - âœ… Correct parent `.shared.css` imported
   - âœ… Class names prefixed with component name (e.g., `.button-root`, `.button-icon`)
   - âœ… `npm run build` succeeds with 0 errors

### Example: Adding a New Nested Group

If adding `src/components/cards/ProgramCard.tsx` and `src/components/cards/EventCard.tsx`:

```txt
src/components/cards/
â”œâ”€â”€ ProgramCard.tsx
â”œâ”€â”€ EventCard.tsx

src/styles/components/cards/
â”œâ”€â”€ .shared.css (imports ../.shared.css)
â”œâ”€â”€ program-card.css (imports ./.shared.css)
â””â”€â”€ event-card.css (imports ./.shared.css)
```

---

## Common Mistakes & How to Avoid Them

### Mistake 1 - Skipping hierarchy levels

```css
/* WRONG: skips .shared.css */
@import '../../themes.css';

.my-component { /* ... */ }
```

### Correct - Skipping hierarchy levels

```css
/* RIGHT: imports immediate parent */
@import './.shared.css';

.my-component { /* ... */ }
```

---

### Mistake 2 - Confusing shared.css with .shared.css

```txt
WRONG: Thinking these are the same file
  â””â”€ src/styles/components/shared.css (component styles for Bullet/Caption/Heading)
  â””â”€ src/styles/components/.shared.css (hierarchy inheritance point)

RIGHT: These are different!
  â””â”€ shared.css = normal component CSS (specific file)
  â””â”€ .shared.css = hierarchy marker (inheritance point for a level)
```

---

### Mistake 3 - Content layer importing .shared.css

```css
/* WRONG: content layer should not import .shared.css */
@import '../components/.shared.css';
@import '../components/footer.css';
```

### Correct - Content layer importing .shared.css

```css
/* RIGHT: content CSS only imports specific component styles */
@import '../components/footer.css';
@import '../components/navigation/nav-shell.css';
```

---

## CSS Delivery & Bundling

### How Styles Reach the Browser

1. **Component-level imports** (TypeScript):
   ```tsx
   import '@/styles/components/footer.css';
   ```

2. **Vite/Rollup bundling:**
   - Vite processes all CSS imports
   - Creates dependency graph (respects hierarchy)
   - Bundles into single file: `dist/assets/index-<hash>.css`

3. **Single CSS file served:**
   - HTML: `<link rel="stylesheet" href="/assets/index-<hash>.css">`
   - Browser loads complete cascade at once

**Why this approach?**
- âœ… Single network request (vs. multiple CSS files)
- âœ… Predictable cascade (hierarchy built in)
- âœ… Tree-shaking (unused styles removed in production)
- âœ… Fast load times (CSS bundled, minified)

---

## Testing Your CSS Architecture

### Automated Validation

Run the dedicated validator before commits:

```bash
npm run lint:styles
```

This script checks that:
- every CSS file obeys the `globals â†’ themes â†’ .shared â†’ component` import ladder;
- placeholder navigation files keep their single `./.shared.css` import;
- TypeScript components and content entries import at most one CSS module via the `@/styles/...` alias (with `src/components/ui/**` exempt by design).

### Quick Verification Checklist

Run these before committing:

```bash
# 1. Style architecture stays intact
npm run lint:styles
# Expected: "Style architecture validation passed."

# 2. Build succeeds
npm run build
# Expected: âœ“ built in ~3.6s, 0 errors

# 3. No circular imports
# (Vite will error if found)

# 4. Dev server runs
npm run dev
# Expected: Runs on localhost:5173, no CSS warnings

# 5. Visual inspection
# Open in browser, inspect elements:
# - All styles applied correctly?
# - Spacing/colors/typography as expected?
# - No unstyled elements?
```

---

## Glossary

- **Hierarchy Level:** A nesting depth where `.shared.css` acts as the inheritance point
- **Semantic Variables:** CSS variables that describe meaning (--primary, --accent) not implementation (--purple)
- **Cascade:** CSS's ability to inherit properties from parent rules
- **Tree-shaking:** Build process removing unused CSS rules
- **.shared.css:** Special filename (dot-prefixed) marking an inheritance level
- **shared.css:** Normal component CSS file (no dot prefix)

---

## Further Reading

- Component structure guide: See `src/components/.COMPONENTS.md`
- Component development: See `src/components/` for working examples
- Adding new pages: See `src/styles/content/` examples
